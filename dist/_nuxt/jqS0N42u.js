import{_ as K,a as Q,b as H}from"./Crp9aCmO.js";import{_ as X}from"./N6g2mK6h.js";import{d as Y,j as Z,l as ee,r as p,m as te,i as oe,o as R,c as N,h as s,f as l,g as o,p as V,w as b,F as S,x as se,s as ne,t as le}from"./RPcYXXev.js";import{b as ae}from"./Be2iH8Rx.js";import{_ as ie}from"./CtWjGfD-.js";import{u as f,L as re}from"./BqkbertX.js";const ue={class:"vl-parent"},ce={class:"w-full flex flex-col"},de={class:"grid grid-cols-2 gap-x-4"},pe={class:"w-full mt-5"},me={class:"flex space-x-3 justify-between"},_e={class:"basis-1/2"},ve={class:"basis-1/2"},be={class:"w-full my-3 flex space-x-4"},fe={class:""},ye={class:""},he={class:"mt-4"},ke=s("div",null,null,-1),ge={class:"w-full mt-5"},Ce={class:""},Ee={class:"flex items-end gap-x-4 mt-5"},xe={class:"w-3/4"},we={class:"w-1/4"},Ue={class:"mt-4"},Re=s("div",null,null,-1),Se=Y({__name:"WorkCenterForm",props:{selectedEmployee:{type:Object,required:!0}},emits:["close","save"],setup(T,{emit:B}){var M;const q=B,E=Z(),D=ee(),x=le(),y=p(!1),W=p(!0),w=p([]),P=p(!1),C=p([]),m=T,i=te({NAME:null,NUMBER:null,position:null});oe(()=>{j()});const A=p({payrollnumber:(M=m==null?void 0:m.selectedEmployee)==null?void 0:M.payrollnumber}),j=async()=>{y.value=!0,F(),U(),L(),y.value=!1},F=async()=>{await f("/api/workcenter/responsibilities",{method:"GET",onResponse({response:t}){t.status===200&&(w.value=t._data.body)},onResponseError({}){w.value=[]}})},U=async()=>{await f("/api/workcenter",{method:"GET",onResponse({response:t}){t.status===200&&(W.value=!0,u.value.options=t._data.body)},onResponseError({}){W.value=!1,u.value.options=[]}})},L=async()=>{await f("/api/employees/workCenter",{method:"GET",params:{...A.value},onResponse({response:t}){if(t.status===200){t._data.body.forEach(e=>{e.WORKCENTERS.split(",").filter(d=>d!=="").map(d=>parseInt(d)).forEach(d=>{C.value.includes(d)||C.value.push(d.toString())})});for(let e=0;e<u.value.options.length;e++){const a=u.value.options[e];C.value.includes(a.uniqueID)&&c.value.push(a)}}},onResponseError({}){C.value=[]}})},$=t=>[],I=async()=>{var t,e;(e=(t=x==null?void 0:x.vnode)==null?void 0:t.props)!=null&&e.onClose?q("close"):D.go(-1)},G=async t=>{var k,g;const e={TimeEntryWithoutJob:h.value.time.isChecked?1:0,Paid:h.value.paid.isChecked?1:0,...t.data},d={WORKCENTERS:`,${c.value.map(_=>_.uniqueID).join(",")},`};if(!u.value.selectedWorkCenter)await f(`/api/employees/${(k=m==null?void 0:m.selectedEmployee)==null?void 0:k.UniqueID}`,{method:"PUT",body:d,onResponse({response:_}){_.status===200&&E.add({title:"Success",description:_._data.message,icon:"i-heroicons-check-circle",color:"green"})}}),U(),I();else{P.value=!0;const _=u.value.selectedWorkCenter.uniqueID;await f(`/api/workcenter/${_}`,{method:"PUT",body:e,onResponse({response:v}){v.status===200&&E.add({title:"Success",description:v._data.message,icon:"i-heroicons-check-circle",color:"green"})}}),await f(`/api/employees/${(g=m==null?void 0:m.selectedEmployee)==null?void 0:g.UniqueID}`,{method:"PUT",body:d,onResponse({response:v}){v.status===200&&E.add({title:"Success",description:v._data.message,icon:"i-heroicons-check-circle",color:"green"})}}),U(),I()}q("save")},u=p({defaultColumns:[{key:"NUMBER",label:"Number"},{key:"NAME",label:"Name"},{key:"res",label:"Person Responsibilites"},{key:"position",label:"Poistion Responsibility"}],options:[],selectedWorkCenter:null,isLoading:!1}),c=p([]),O=t=>{const e=c.value.findIndex(r=>r.uniqueID===t.uniqueID);e===-1?c.value.push(t):c.value.splice(e,1),u.value.selectedWorkCenter={...t,class:""},u.value.options.forEach(r=>{r.uniqueID===t.uniqueID?r.class="bg-gray-200":delete r.class});const a=u.value.selectedWorkCenter;i.NAME=a.NAME,i.NUMBER=a.NUMBER,i.position=a.position,h.value.time.isChecked=a.TimeEntryWithoutJob,h.value.paid.isChecked=a.Paid},J=p([{key:"serial",label:"Workcenter Skills"}]),h=p({time:{label:"Time Entry Without Job?",isChecked:!1},paid:{label:"Paid?",isChecked:!1}});return(t,e)=>{const a=K,r=Q,d=X,k=ne,g=ae,_=ie,v=H;return R(),N(S,null,[s("div",ue,[l(o(re),{active:o(y),"onUpdate:active":e[0]||(e[0]=n=>V(y)?y.value=n:null),"is-full-page":!0,color:"#000000",backgroundColor:"#1B2533",loader:"dots"},null,8,["active"])]),l(v,{validate:$,"validate-on":["submit"],state:o(i),class:"space-y-4",onSubmit:G},{default:b(()=>[s("div",ce,[s("div",de,[s("div",pe,[s("div",me,[s("div",_e,[l(r,{label:"Number",name:"Number"},{default:b(()=>[l(a,{modelValue:o(i).NUMBER,"onUpdate:modelValue":e[1]||(e[1]=n=>o(i).NUMBER=n)},null,8,["modelValue"])]),_:1})]),s("div",ve,[l(r,{label:"Name",name:"Name"},{default:b(()=>[l(a,{modelValue:o(i).NAME,"onUpdate:modelValue":e[2]||(e[2]=n=>o(i).NAME=n)},null,8,["modelValue"])]),_:1})])]),s("div",be,[(R(!0),N(S,null,se(o(h),n=>(R(),N("div",fe,[l(d,{modelValue:n.isChecked,"onUpdate:modelValue":z=>n.isChecked=z,label:n.label},null,8,["modelValue","onUpdate:modelValue","label"])]))),256))]),s("div",ye,[l(k,{icon:"i-heroicons-document-text",type:"submit",variant:"outline",color:"green",label:"Save",ui:{base:"w-full",truncate:"flex justify-center w-full"},truncate:""})]),s("div",he,[l(g,{modelValue:o(c),"onUpdate:modelValue":e[3]||(e[3]=n=>V(c)?c.value=n:null),selected:o(c),"onUpdate:selected":e[4]||(e[4]=n=>V(c)?c.value=n:null),columns:o(u).defaultColumns,rows:o(u).options,ui:{wrapper:"h-[528px] border-2 border-gray-300 dark:border-gray-700",tr:{active:"hover:bg-gray-200 dark:hover:bg-gray-800/50"},th:{base:"sticky top-0 z-10",color:"bg-white dark:text-gray dark:bg-[#111827]",padding:"px-2 py-0"},td:{base:"h-[31px]",padding:"px-2 py-0"}},onSelect:O},{"empty-state":b(()=>[ke]),_:1},8,["modelValue","selected","columns","rows"])])]),s("div",ge,[s("div",Ce,[l(r,{label:"Position Responsibilites",name:"Position Responsibilites"},{default:b(()=>[l(_,{modelValue:o(i).position,"onUpdate:modelValue":e[5]||(e[5]=n=>o(i).position=n),query:o(i).position,"onUpdate:query":e[6]||(e[6]=n=>o(i).position=n),options:o(w)},null,8,["modelValue","query","options"])]),_:1})]),s("div",Ee,[s("div",xe,[l(r,{label:"Account",name:"Account"},{default:b(()=>[l(_,{options:[]})]),_:1})]),s("div",we,[l(k,{color:"blue",variant:"outline",ui:{base:"w-full",truncate:"flex justify-center w-full"},label:"Load QB",icon:"i-heroicons-pencil-square"})])]),s("div",Ue,[l(g,{columns:o(J),ui:{wrapper:"h-[528px] border-2 border-gray-300 dark:border-gray-700",th:{base:"sticky top-0 z-10",color:"bg-white dark:text-gray dark:bg-[#111827]",padding:"p-1"}}},{"empty-state":b(()=>[Re]),_:1},8,["columns"])])])])])]),_:1},8,["state"])],64)}}});export{Se as _};
