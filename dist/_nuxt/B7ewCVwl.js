import{_ as b}from"./BUq1NvRd.js";import{d,i as f,u as k,a as y,j as v,r as a,k as g,o as C,e as h}from"./RPcYXXev.js";import{u as i}from"./BqkbertX.js";import"./BzVEqXPg.js";import"./B4XmkEM1.js";import"./BYchAQ3Y.js";import"./DTMMRf-M.js";import"./Be2iH8Rx.js";import"./Crp9aCmO.js";import"./N6g2mK6h.js";import"./yGFOaDKw.js";import"./BQUlXvKt.js";import"./CBKg8vbb.js";import"./lE0Kizl1.js";import"./DHKz6DHT.js";import"./CZLIIVqG.js";import"./DBeKXjhb.js";import"./CtWjGfD-.js";import"./DFiUDov5.js";import"./C1sp2X5w.js";import"./Dw6iTx8h.js";import"./CZ9EiQCe.js";import"./rJN6zrQ_.js";import"./D923ZLaS.js";import"./OsgMrgDf.js";import"./CIB32lOs.js";import"./3snQ80t5.js";import"./E1zpYRWT.js";const K=d({__name:"list",setup(O){f(()=>{c()}),k({title:"Grimm-Customers"});const u=y();v();const r=a({markets:{label:"Market",filter:"market",options:[]},professions:{label:"Profession",filter:"source",options:[]},categories:{label:"Category",filter:"ParadynamixCatagory",options:[]},conferences:{label:"Conference",filter:"SourceConfrence",options:[]},usstates:{label:"State",filter:"state",api:"/api/common/usstates",options:[]}}),e=a({defaultColumns:[{key:"number",label:"Number",sortable:!0,sortDirection:"none",filterable:!0},{key:"fname",label:"First",sortable:!0,sortDirection:"none",filterable:!0},{key:"lname",label:"Last",sortable:!0,sortDirection:"none",filterable:!0},{key:"company1",label:"Company",sortable:!0,sortDirection:"none",filterable:!0},{key:"homephone",label:"HomePhone",sortable:!0,sortDirection:"none",filterable:!0},{key:"workphone",label:"WorkPhone",sortable:!0,sortDirection:"none",filterable:!0},{key:"state",label:"State",sortable:!0,sortDirection:"none",filterable:!0},{key:"zip",label:"Zip",sortable:!0,sortDirection:"none",filterable:!0},{key:"label",label:"Label",kind:"actions"},{key:"order",label:"Order",kind:"actions"},{key:"quote",label:"Quote",kind:"actions"},{key:"serviceOrder",label:"Service Order",kind:"actions"},{key:"siteVisit",label:"Site Visit",kind:"actions"},{key:"edit",label:"Edit",kind:"actions"},{key:"delete",label:"Del",kind:"actions"}],page:1,pageSize:50,numberOfCustomers:0,customers:[],selectedCustomerId:null,sort:{column:"UniqueID",direction:"asc"},isLoading:!1});a({isCustomerModalOpen:!1,isOrderDetailModalOpen:!1,isQuoteDetailModalOpen:!1,isServiceOrderDetailModalOpen:!1,isSiteVisitModalOpen:!1,modalTitle:"New Customer"});const n=a({market:null,source:null,ParadynamixCatagory:null,SourceConfrence:null,number:null,fname:null,lname:null,company1:null,homephone:null,workphone:null,state:null,zip:null}),m=a(e.value.defaultColumns);a(!1),g(()=>e.value.defaultColumns.filter(t=>m.value.includes(t))),Object.entries(u.query).forEach(([t,o])=>{switch(t.toLowerCase()){case"page":e.value.page=Number(o);break;case"pagesize":e.value.pageSize=Number(o);break;case"sortby":e.value.sort.column=o;break;case"sortorder":e.value.sort.direction=o;break}});const c=async()=>{var t;p();for(const o in r.value){console.log("the key is",o);const s=((t=r.value[o])==null?void 0:t.api)??`/api/customers/${o}`;await i(s,{method:"GET",onResponse({response:l}){l.status===200&&(r.value[o].options=[null,...l._data.body],console.log("the response is",l._data.body))}})}},p=async()=>{if(e.value.isLoading=!0,await i("/api/customers/numbers",{method:"GET",params:{...n.value},onResponse({response:t}){t.status===200&&(e.value.numberOfCustomers=t._data.body)}}),e.value.numberOfCustomers===0){e.value.customers=[],e.value.numberOfCustomers=0,e.value.isLoading=!1;return}e.value.page*e.value.pageSize>e.value.numberOfCustomers&&(e.value.page=Math.ceil(e.value.numberOfCustomers/e.value.pageSize)|1),await i("/api/customers/",{method:"GET",params:{page:e.value.page,pageSize:e.value.pageSize,sortBy:e.value.sort.column,sortOrder:e.value.sort.direction,...n.value},onResponse({response:t}){t.status===200&&(e.value.customers=t._data.body,console.log("the customer area",t._data.body)),e.value.isLoading=!1}})};return(t,o)=>{const s=b;return C(),h(s,{"is-page":!0})}}});export{K as default};
